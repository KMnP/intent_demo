<!DOCTYPE HTML>
<html>
  <head>
    <title>Images with different motives</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" />
    <script>
            STATIC_ROOT = "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/static";
            // STATIC_ROOT = "static"
            $('<link>').attr('rel','stylesheet')
              .attr('type','text/css')
              .attr('href',STATIC_ROOT + '/assets/css/main.css')
              .appendTo('head');
        </script>
    <!-- <link rel="stylesheet" href="assets/css/main.css" /> -->
  </head>
  <body>
    <!-- Splash page -->
    <div id="splashscreen">
      <div class="inner">
        <h1>Welcome to this study!</h1>
        <p>
          Suppose you took a photo that you’d like to share on Instagram, but for various reasons (e.g., privacy or licensing concerns), you’re not allowed to post it. You had a certain intent or motivation in mind when taking the photo that you wanted to express by posting it.
        </p>
        <p>
          Now suppose that, instead of posting nothing, you have the opportunity to post an alternative photo that expresses as similar intent as possible.
        </p>
        <p>
          The following tasks capture this idea, and allow you to express your opinion on which photos could be good substitutes in this respect.
        </p>
        <div class='col-xs-4 col-xs-offset-4 text-center' id='button-splash'>
          <button id='continue-btn' class='btn btn-lg btn-primary' >Click to continue</button>
        </div>
      </div>
    </div>

    <!-- Collapsible instructions -->
    <button class="collapsible">Click for More Instructions <i>(Best view in a full screen setting)</i> </button>
      <div class="collapsible-content">
        <p>
          Suppose you took a photo that you’d like to share on Instagram, but for various reasons (e.g., privacy or licensing concerns), you’re not allowed to post it. You had a certain intent or motivation in mind when taking the photo that you wanted to express by posting it. <br />
          Now suppose that, instead of posting nothing, you have the opportunity to post an alternative photo that expresses as similar intent as possible. <br />
          The following tasks capture this idea, and allow you to express your opinion on which photos could be good substitutes in this respect.
        </p>
      </div>

    <div class="page-wrap" style="max-width:1680px; margin:0 auto;">
      <!-- Main -->
        <section id="main">
          <!-- Task Descriptions -->
            <section id="section">
              <div class="inner">
                <p style="font-size:110%;">
                  Click to dismiss any image that <strong><font color="RED">wouldn’t serve as a good substitute</font></strong> for the intent of the image on the left. <br />
                  If none of them are good fits, feel free to dismiss all of them.
                <!-- Can you choose from the images on the right that convey <strong><font color="Tomato">different motive</font></strong>? -->
              </p>
              </div>
            </section>

          <!-- Selections -->
            <section id="selections">
              <!-- put query image here -->
                <div class="social column">
                  <h3>Image you want to post</h3>
                  <span class="image fit special"><div id='query-container'></div></span>
                </div>

              <!-- Grid -->
                <div class="column">
                  <!-- <h3>Click on any images on the right that <strong><font color="RED">you can easily dismiss</font></strong>, leaving the ones that convey similar intent.</h3> -->
                  <h3>Please <font color="RED">click on the images to select</font>, <font color="LIMEGREEN">double-click to remove selection</font>. Scroll down to see more images.</h3>
                  <div class="gallery">
                    <div class="content">
                      <!-- row 1 -->
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>

                      <!-- row 2 -->
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>

                      <!-- row 3 -->
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>

                      <!-- row 4 -->
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>
                      <div class="media">
                        <span class="image fit"><div class='image-container'></div></span>
                      </div>

                    </div>
                  </div>
                </div>
            </section>
            <!-- Footer for buttons-->
              <footer id="footer">
                <div class='col-xs-4 col-xs-offset-4 text-center' id='button-div'>
                  <button id='prev-btn' class='btn btn-lg btn-primary' disabled>Back</button>
                  <span id='counter'>
                  <span class='counter-top'></span> / <span class='counter-bottom'></span>
                  </span>
                  <button id='next-btn' class='btn btn-lg btn-primary' disabled>Next</button>
                </div>
              </footer>
        </section>
    </div>

    <!-- Scripts -->
    <script>
      STATIC_ROOT = "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/static";
      // STATIC_ROOT = "../static";
      $.getScript(STATIC_ROOT + '/assets/js/jquery.min.js');
      $.getScript(STATIC_ROOT + '/assets/js/jquery.poptrox.min.js');
      $.getScript(STATIC_ROOT + '/assets/js/jquery.scrolly.min.js');
      $.getScript(STATIC_ROOT + '/assets/js/skel.min.js');
      $.getScript(STATIC_ROOT + '/assets/js/util.js');
      $.getScript(STATIC_ROOT + '/assets/js/main.js');
      $.getScript(STATIC_ROOT + '/assets/js/collapsible.js');
      $.getScript(STATIC_ROOT + '/assets/js/splash.js');
    </script>
    <script type='text/json' id='input'>
  [["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/4a7ff6bdff0fc506b5840dbdb7413d13.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/8a9543b7194adbfbbd07fc0ca82afd26.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/9fd219ef2cbeae09469dc4c3c5d395e3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/854bbff139588422a51c91f0cab0d5ac.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/82997870bb89c1c5ce8537d979e215fa.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/4d6b931b75b4a5c6f279ec4c8c77a8b6.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/35af2cfe19d2d6654c7e50b1fbdbb688.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/6e9e19124867a49e0b50f2049b110bb3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/3d618a7b45556b2f7801edb572f9b7bd.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/32342cbf7bd3d8126e5fa1628c4e12f7.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/21cb6b3cbe329e038a5e1c6d0f2644c1.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/68976479925a926d34c22f1da8ceda5c.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/7b3dc2c181368bb6dc71c47db9aa6406.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/c6f3307b117c8c1d547c033954826bb2.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/0c822bf7643851d085bd37ec463d49c0.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/95eee7ff62d5dcecdea600e990f485af.jpg"], ["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/c20ad4d76fe97759aa27a0c99bff6710.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/faeac4e1eef307c2ab7b0a3821e6c667.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/d72d187df41e10ea7d9fcdc7f5909205.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/0a8005f5594bd67041f88c6196192646.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/fad6f4e614a212e80c67249a666d2b09.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/d9d4f495e875a2e075a1a4a6e1b9770f.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/1ff1de774005f8da13f42943881c655f.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/67c6a1e7ce56d3d6fa748ab6d9af3fd7.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/70efdf2ec9b086079795c442636b55fb.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/9bf31c7ff062936a96d3c8bd1f8f2ff3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/182be0c5cdcd5072bb1864cdee4d3d6e.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/4e732ced3463d06de0ca9a15b6153677.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/aab3238922bcc25a6f606eb525ffdc56.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/d67d8ab4f4c10bf22aa353e27879133c.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/c16a5320fa475530d9583c34fd356ef5.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/f7177163c833dff4b38fc8d2872f1ec6.jpg"], ["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/0c5a56366e8b1b98f6fa97957746d5ad.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/cd81128132d06c19f287a418ad1f2827.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/2e146761c5969593f565b69f08ce55fa.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/e599c65ebd861d8bfff5b91e6011799d.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/44a42983a03c0d4e0c9e86320847a7fc.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/02d2c1641e237debd81a0a90801df7c9.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/70c64bea2bf9ff6672c2eeab8ca107a4.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/08f784ec9fc09c96f468213cd0318cae.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/8cc92422d8d47f6cdbb679c2fe68d647.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/ce9e09a8c3175f0393e1163b77114ca3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/23fbda26627f5d0dedeb892733489024.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/6ab936c0888d953797219bb73c8d28b5.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/00e43e7a4620de2729ca25770c30ec82.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/ad832d7315d6df65adf6445278087a21.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/be03455c8c082a881d6655de4c04b1f4.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/aeae01654794996e6243009bb231c3fa.jpg"], ["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/456ff405e97474cf6dfb762a4f1d7dea.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/687360160b7ea512717dc5b329197f95.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/9edce3abd6c768d51d3607989066ebd3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/7763aa4a8eebde3cc06abaa7c8c1ecee.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/330fa60faa5aec95f9090a6c94572f28.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/234a1f1eed7d1d9662158852fc1e8086.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/f28b52da491a188a9e519d0b28a71539.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/0ef0831018370ace9b808cdc2c37e90c.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/19be3bcdea3138fd9d9157ebadcbd3a6.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/d002e44f53afc6f88cdebf2fef873eee.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/2b2fa2c5f7c5374664c494b735e46623.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/57978bcd66e45475aa6e7da85b07988c.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/80a011303c14906e33ad49690d0e12e2.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/c0871b7c7052b11b9c9f3d2078f882fb.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/44064e21d8c5e33b6442e8662ab2f532.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/happy/ceb0a299bf273908cebfcd8ad3dad696.jpg"], ["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/3798e50bde45107fe21e2f9ffc63c1fd.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/6ae50ff28661b78932b4fa68b380b7b3.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/c98a7d83218b02a5a09aab3b7fca3bf1.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/7c877b2b8aad32dd9b5ab7de14504b0a.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/e45ee7ce7e88149af8dd32b27f9512ce.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/89fc700ef0365738e09cc7496f21472b.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/b1bcaa856a13475d77e97cfdfef43e5d.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/0cde23a602733c1dbf5ebac99d57e031.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/f030c4212d877cb2b56bc82d6dd20640.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/7b133710b9150f5c32e0973f748055fc.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/f153e76d4927bb24b44781487dc9588d.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/b37a1a4c976b6090a84194097b8e62ae.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/25bf483c5ca147a191658945bd2ee61e.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/549de6d66bc6fe09f6fa2730d3cb4303.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/ee70cbbfa9d17f1abb7646b297237cb6.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/travel/545ac2df2f05a613d8da47c3308544b5.jpg"], ["https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/751d31dd6b56b26b29dac2c0e1839e34.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/6512bd43d9caa6e02c990b0a82652dca.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/7d0665438e81d8eceb98c1e31fca80c1.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/a2ef406e2c2351e0b9e80029c909242d.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/37693cfc748049e45d87b8c7d8b9aacd.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/642e92efb79421734881b53e1e1b18b6.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/a5771bce93e200c36f7cd9dfd0e5deaa.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/d645920e395fedad7bbbed0eca3fe2e0.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/e369853df766fa44e1ed0ff613f563bd.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/02e74f10e0327ad868d138f2b4fdd6f0.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/a1d0c6e83f027327d8461063f4ac58a6.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/3416a75f4cea9109507cacd8e2f2aefc.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/c51ce410c124a10e0db5e4b97fc2af39.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/6f4922f45568161a8cdf4ad2299f6d23.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/34173cb38f07f89ddbebc2ac9128303f.jpg", "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/images/random/1c383cd30b7c298ab50293adfecb7b18.jpg"]]
</script>
<script type='text/json' id='query'>
  ["https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80", "https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80", "https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80", "https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80", "https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80", "https://images.unsplash.com/photo-1565363887211-f84e8598833a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1301&q=80"]
</script>

<form id='results-form' method='post' action='dummy' class='text-center'>
  <input type='hidden' value='' name='output' id='output'/>
  <input type="hidden" id="assignmentId" name="assignmentId" value='MTURK_ASSIGNMENT_ID'>
  <div class='col-xs-4 col-xs-offset-4 text-center' id='button-div'>
    <input type='submit' class='btn btn-lg btn-success' id='submit-btn' value='Submit' disabled/>
  </div>
</form>
<script>
  var simpleamt = (function() {

    // Copied from http://james.padolsey.com/javascript/bujs-1-getparameterbyname/
    function getUrlParam(name) {
      var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
      return match ? decodeURIComponent(match[1].replace(/\+/g, ' ')) : null;
    }

    function getQuery(default_query) {
      if (typeof(default_query) === 'undefined') default_query = null;
      try {
        return JSON.parse($('#query').html());
      } catch (e) {
        console.log($('#query').html())
        return default_query;
      }
    }

    function getInput(default_input) {
      if (typeof(default_input) === 'undefined') default_input = null;
      try {
        return JSON.parse($('#input').html());
      } catch (e) {
        console.log($('#input').html())
        return default_input;
      }
    }

    function setOutput(output) {
      $('#output').val(JSON.stringify(output));
    }

    function isPreview() {
      var assignment_id = getUrlParam('assignmentId');
      if (assignment_id === null) return true;
      // if (assignment_id === null) return false;
      return assignment_id == 'ASSIGNMENT_ID_NOT_AVAILABLE';
    }

    function setupSubmit() {
      var submit_to = getUrlParam('turkSubmitTo');
      $('#results-form').attr('action', submit_to + '/mturk/externalSubmit');
      $('#assignmentId').val(getUrlParam('assignmentId'));
    }

    return {
      getQuery: getQuery,
      getInput: getInput,
      setOutput: setOutput,
      isPreview: isPreview,
      setupSubmit: setupSubmit,
    }

  })();
</script>

    <script>
      $(function() {
        // Define some default input.
        // var STATIC_ROOT = "https://intentology.s3.us-east-2.amazonaws.com/intent_annotation/static"
        var DEFAULT_QUERY = [];

        var DEFAULT_INPUT = [];

        var query = null;
        var input = null;

        // responses from users, parallel to input.
        var responses = [];

        // Some variables to track state of the HIT.
        var idx = 0;
        var enabled = false;

        // Output
        var output = {}

        function main() {
          // If this is a HIT on AMT, then replace the default input with the real input.
          query = simpleamt.getQuery(DEFAULT_QUERY)

          // input for grid images
          input = simpleamt.getInput(DEFAULT_INPUT);

          // Enable the UI if the HIT is not in preview mode.
          // if (!simpleamt.isPreview()) {
          //   enable_hit();
          // }
          if (!simpleamt.isPreview()) {
            enable_hit();
          } else {
            test();
          }

          // Set up the responses for each query.
          $.each(query, function (){
            responses.push([]);
          });

          // Preload all images
          // var imgs = [];
          $.each(query, function(query_idx, value){
            $.each(input[query_idx], function(i, img_url) {
              var img = new Image();
              img.onload = function() {
                // console.log('loaded image from ' + img_url); 
              };
              // img.src = img_url + "?t=" + new Date().getTime();
              img.src = img_url;
            });
          });

          render();
        }

        // Use the current index to update the image and description
        function render() {
          // scroll up to the top
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
          // console.log(idx)
          // Set up the image
          $('#query-container').empty();
          $('<img>').attr({'src': query[idx]}).appendTo($('#query-container'));
          // console.log('render: loaded proxy image from ' + query);

          // Set up the grid
          $('.image-container').each(function(index){
            $(this).empty();
            $('<img>').attr({'src': input[idx][index]}).appendTo($(this));
            // console.log('render: loaded image from ' + input[idx][index]);
          });


          // Refresh the counter
          $('.counter-top').text(idx + 1);
          $('.counter-bottom').text(input.length);

          // Set the media according to responses
          $(".media").filter(".selected").removeClass('selected');
          if (responses[idx].length !== 0) {
            // set up the grid according to previous selection
            $('.media').each(function(){
              $img = $(this).find('img');
              // if this image is in the responses
              if(jQuery.inArray($img.attr('src'), responses[idx]) !== -1) {
                $(this).addClass('selected');
              }
          })
          } else {
            responses[idx] = [];
          }

          // If the UI is enabled, enable or disable the buttons
          // depending on the index.
          if (enabled) {
            var prev_btn = $('#prev-btn');
            var next_btn = $('#next-btn');
            var submit_btn = $('#submit-btn');
            prev_btn.prop('disabled', true);
            next_btn.prop('disabled', true);
            submit_btn.prop('disabled', false);
            if (idx > 0) {
              prev_btn.prop('disabled', false);
            }
            if (idx < query.length - 1) {
              next_btn.prop('disabled', false);
              submit_btn.prop('disabled', true);
            }
          }
        }

        // Update the index, and save the clicked responses from gallery.
        function set_idx(new_idx) {
          if (new_idx < 0 || new_idx >= input.length) return;

          $('.selected').each(function(){
            $img = $(this).find('img');
            // add to the responses if not in array
            if(jQuery.inArray($img.attr('src'), responses[idx]) === -1) {
              responses[idx].push($img.attr('src'))
            }
          })
          // console.log(responses)
          if (responses[idx].length < 1) {
            alert('No image selected at this page. Correct before continue.');
            return false;
          }
          idx = new_idx;
          render();
        }

        function set_idx_back(new_idx) {
          if (new_idx < 0 || new_idx >= input.length) return;

          $('.selected').each(function(){
            $img = $(this).find('img');
            // add to the responses if not in array
            if(jQuery.inArray($img.attr('src'), responses[idx]) === -1) {
              responses[idx].push($img.attr('src'))
            }
          })
          idx = new_idx;
          render();
        }

        // Test the output
        function test() {
          enabled = true;
          // Enable components
          $('#next-btn').click(function() { set_idx(idx + 1) });
          $('#prev-btn').click(function() { set_idx_back(idx - 1) });
          if (idx == query.length - 1) {
              $('#submit-btn').prop('disabled', false);
          }

          $('#submit-btn').click(function() {
            alert('This is for demo purpose. No responses will be submitted. You can view the results in console.');
            // clear responses
            responses[idx] = [];
            $('.selected').each(function(){
              $img = $(this).find('img');
              responses[idx].push($img.attr('src'))
            })

            if (responses[idx].length < 1) {
              alert('No image selected at this page. Correct before submitting.');
              return false;
            }

            var output = query.map(function(q, i) {
              return {'target': q, 'responses': responses[i]};
            });
            console.log(output)
          });
        }
        // Enable the UI.
        function enable_hit() {
          enabled = true;

          // Enable components
          $('#next-btn').click(function() { set_idx(idx + 1) });
          $('#prev-btn').click(function() { set_idx(idx - 1) });
          $('#submit-btn').prop('disabled', false);
          if (idx == query.length - 1) {
              $('#submit-btn').prop('disabled', false);
          }

          // Set up submit handler.
          simpleamt.setupSubmit();
          $('#submit-btn').click(function() {
            // clear responses
            responses[idx] = [];
            $('.selected').each(function(){
              $img = $(this).find('img');
              responses[idx].push($img.attr('src'))
            })

            if (responses[idx].length < 1) {
              // Validate the output
              alert('No image selected at this page. Correct before submitting.');
              return false;
            } else {
              // prepare output
              var output = query.map(function(q, i) {
                return {'target': q, 'responses': responses[i]};
              });
              simpleamt.setOutput(output);
            }
          });
        }

        main();
      });
    </script>

  </body>
</html>